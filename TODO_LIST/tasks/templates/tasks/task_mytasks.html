{% extends "base.html" %}
{% block title %}Minhas Tarefas - {{ project.name }}{% endblock %}
{% block page_title %}Tarefas do Projeto {{ project.name }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6 bg-white rounded-lg shadow">
  <h2 class="text-xl font-semibold mb-4">Minhas tarefas neste projeto</h2>

  {% if tasks %}
    <ul class="space-y-4">
      {% for task in tasks %}
        <li class="border rounded p-4 flex justify-between items-start gap-4">
          <div>
            <a href="{% url 'task-detail' task.pk %}" class="text-lg font-medium text-indigo-600">{{ task.name }}</a>
            <p class="text-sm text-gray-600">{{ task.get_status_display }} • {{ task.get_priority_display }}</p>
            <p class="text-sm text-gray-500 mt-1">Criador: {{ task.owner.name|default:"—" }}</p>
          </div>

          {% if task.assigned_to == resquest.user or resquest.user == resquest.user.is_superuser %}
          
          

          <div class="flex gap-2 items-center">
            {% if task.status == 'in_progress' %}
            <a href="{% url 'task-complete' task.pk %}" class="px-3 py-2 bg-green-600 text-white rounded">Concluir</a>

            <a href="{% url 'task-cancel' task.pk %}" class="px-3 py-2 bg-red-600 text-white rounded">Cancelar</a>
            {% endif %}

            {% if task.status != 'in_progress' %}
            <a href="{% url 'task-reopen' task.pk %}" class="px-3 py-2 bg-yellow-600 text-white rounded">Reabrir</a>
            {% endif %}
          </div>
          {% endif %}

          

          {% if task.owner == request.user or request.user.is_superuser %}
          
          <div class="flex gap-2 items-center">
            <a href="{% url 'task-update' task.pk %}" class="px-3 py-2 bg-gray-600 text-white rounded">Editar</a>
             
            <a href="{% url 'task-delete' task.pk %}" class="px-3 py-2 bg-red-600 text-white rounded">Deletar</a>
          </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="text-gray-500">Nenhuma tarefa atribuída a você neste projeto.</p>
  {% endif %}
</div>
{% endblock %}
